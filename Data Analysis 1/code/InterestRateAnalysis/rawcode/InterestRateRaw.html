<html>

<head>
<style type="text/css">.knitr.inline {
  background-color: #f7f7f7;
  border:solid 1px #B0B0B0;
}
.error {
	font-weight: bold;
	color: #FF0000;
}, 
.warning {
	font-weight: bold;
} 
.message {
	font-style: italic;
} 
.source, .output, .warning, .error, .message {
	padding: 0em 1em;
  border:solid 1px #F7F7F7;
}
.source {
  background-color: #f7f7f7;
}
.rimage.left {
  text-align: left;
}
.rimage.right {
  text-align: right;
}
.rimage.center {
  text-align: center;
}

.source {
  color: #333333;
}
.background {
  color: #F7F7F7;
}

.number {
  color: #000000;
}

.functioncall {
  color: #800054;
  font-weight: bolder;
}

.string {
  color: #9999FF;
}

.keyword {
  font-weight: bolder;
  color: black;
}

.argument {
  color: #B04005;
}

.comment {
  color: #2E9957;
}

.roxygencomment {
  color: #707AB3;
}

.formalargs {
  color: #B04005;
}

.eqformalargs {
  color: #B04005;
}

.assignement {
  font-weight: bolder;
  color: #000000;
}

.package {
  color: #96B525;
}

.slot {
  font-style: italic;
}

.symbol {
  color: #000000;
}

.prompt {
  color: #333333;
}
</style>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>Raw Interest Rate Analysis</title>
<!-- <link href="stylesheet.css" rel="stylesheet"> -->
</head>

<body>

<h1>Raw Interest Rate Analysis</h1>

<h2>Load Library<h2>


<h2>Processing</h2>
<p>Download the data, read the data in and save as an RDA file</p>

<div class="chunk" id="Data treatment"><div class="rcode"><div class="source"><pre class="knitr r"><span class="functioncall">getwd</span>()
</pre></div><div class="output"><pre class="knitr r">## [1] "/Users/Carlos/Dropbox/Courses/Data Analysis/Exercices/Data Analysis/Data Analysis 1/code/InterestRateAnalysis/rawcode"
</pre></div><div class="source"><pre class="knitr r"><span class="comment">#</span>
# <span class="functioncall">download.file</span>(<span class="string">'https://spark-public.s3.amazonaws.com/dataanalysis/loansData.csv'</span>,
# destfile=<span class="string">'../../../data/loansData.csv'</span>, method = <span class="string">'curl'</span>)
dateDownloaded &lt;- <span class="functioncall">date</span>()
dateDownloaded
</pre></div><div class="output"><pre class="knitr r">## [1] "Sat Feb 16 10:39:17 2013"
</pre></div><div class="source"><pre class="knitr r">loans &lt;- <span class="functioncall">read.csv</span>(<span class="string">"../../../data/loansData.csv"</span>, stringsAsFactors = <span class="keyword">FALSE</span>)
# <span class="functioncall">save</span>(loans,dateDownloaded, file=<span class="string">'../../../data/loansData.rda'</span>)
</pre></div></div></div>


<h2>Munging Data</h2>
<div class="chunk" id="Munging Data"><div class="rcode"><div class="source"><pre class="knitr r"><span class="comment"># Convert Interest Rate to numeric</span>
loans$Interest.Rate &lt;- <span class="functioncall">as.numeric</span>(<span class="functioncall">gsub</span>(<span class="string">"%"</span>, <span class="string">""</span>, loans$Interest.Rate))
<span class="comment"># Convert Loan Lenght to numeric</span>
loans$Loan.Length &lt;- <span class="functioncall">as.numeric</span>(<span class="functioncall">gsub</span>(<span class="string">"months"</span>, <span class="string">""</span>, loans$Loan.Length))
<span class="comment"># Factor Loan Purpose</span>
loans$Loan.Purpose &lt;- <span class="functioncall">as.factor</span>(loans$Loan.Purpose)
<span class="comment"># Convert Debt to Income Ratio to numeric</span>
loans$Debt.To.Income.Ratio &lt;- <span class="functioncall">as.numeric</span>(<span class="functioncall">gsub</span>(<span class="string">"%"</span>, <span class="string">""</span>, loans$Debt.To.Income.Ratio))
<span class="comment"># Factor State</span>
loans$State &lt;- <span class="functioncall">as.factor</span>(loans$State)
<span class="comment"># Factor Home Ownership</span>
loans$Home.Ownership &lt;- <span class="functioncall">as.factor</span>(loans$Home.Ownership)
<span class="comment"># Factor FICO Range</span>
loans$FICO.Range &lt;- <span class="functioncall">as.factor</span>(loans$FICO.Range)
<span class="comment"># Factor Employment Lenght</span>
loans$Employment.Length &lt;- <span class="functioncall">as.factor</span>(loans$Employment.Length)
</pre></div></div></div>




<h3>Look at the data set</h3>

<div class="chunk" id="Look at the data set"><div class="rcode"><div class="source"><pre class="knitr r"><span class="functioncall">head</span>(loans)
</pre></div><div class="output"><pre class="knitr r">##       Amount.Requested Amount.Funded.By.Investors Interest.Rate
## 81174            20000                      20000          8.90
## 99592            19200                      19200         12.12
## 80059            35000                      35000         21.98
## 15825            10000                       9975          9.99
## 33182            12000                      12000         11.71
## 62403             6000                       6000         15.31
##       Loan.Length       Loan.Purpose Debt.To.Income.Ratio State
## 81174          36 debt_consolidation                14.90    SC
## 99592          36 debt_consolidation                28.36    TX
## 80059          60 debt_consolidation                23.81    CA
## 15825          36 debt_consolidation                14.30    KS
## 33182          36        credit_card                18.78    NJ
## 62403          36              other                20.05    CT
##       Home.Ownership Monthly.Income FICO.Range Open.CREDIT.Lines
## 81174       MORTGAGE           6542    735-739                14
## 99592       MORTGAGE           4583    715-719                12
## 80059       MORTGAGE          11500    690-694                14
## 15825       MORTGAGE           3833    695-699                10
## 33182           RENT           3195    695-699                11
## 62403            OWN           4892    670-674                17
##       Revolving.CREDIT.Balance Inquiries.in.the.Last.6.Months
## 81174                    14272                              2
## 99592                    11140                              1
## 80059                    21977                              1
## 15825                     9346                              0
## 33182                    14469                              0
## 62403                    10391                              2
##       Employment.Length
## 81174          < 1 year
## 99592           2 years
## 80059           2 years
## 15825           5 years
## 33182           9 years
## 62403           3 years
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">summary</span>(loans)
</pre></div><div class="output"><pre class="knitr r">##  Amount.Requested Amount.Funded.By.Investors Interest.Rate  
##  Min.   : 1000    Min.   :    0              Min.   : 5.42  
##  1st Qu.: 6000    1st Qu.: 6000              1st Qu.:10.16  
##  Median :10000    Median :10000              Median :13.11  
##  Mean   :12406    Mean   :12002              Mean   :13.07  
##  3rd Qu.:17000    3rd Qu.:16000              3rd Qu.:15.80  
##  Max.   :35000    Max.   :35000              Max.   :24.89  
##                                                             
##   Loan.Length               Loan.Purpose  Debt.To.Income.Ratio
##  Min.   :36.0   debt_consolidation:1307   Min.   : 0.00       
##  1st Qu.:36.0   credit_card       : 444   1st Qu.: 9.75       
##  Median :36.0   other             : 201   Median :15.32       
##  Mean   :41.3   home_improvement  : 152   Mean   :15.38       
##  3rd Qu.:36.0   major_purchase    : 101   3rd Qu.:20.67       
##  Max.   :60.0   small_business    :  87   Max.   :34.91       
##                 (Other)           : 208                       
##      State       Home.Ownership Monthly.Income     FICO.Range  
##  CA     : 433   MORTGAGE:1148   Min.   :   588   670-674: 171  
##  NY     : 255   NONE    :   1   1st Qu.:  3500   675-679: 166  
##  TX     : 174   OTHER   :   5   Median :  5000   680-684: 157  
##  FL     : 169   OWN     : 200   Mean   :  5689   695-699: 153  
##  IL     : 101   RENT    :1146   3rd Qu.:  6800   665-669: 145  
##  GA     :  98                   Max.   :102750   690-694: 140  
##  (Other):1270                   NA's   :1        (Other):1568  
##  Open.CREDIT.Lines Revolving.CREDIT.Balance Inquiries.in.the.Last.6.Months
##  Min.   : 2.0      Min.   :     0           Min.   :0.000                 
##  1st Qu.: 7.0      1st Qu.:  5586           1st Qu.:0.000                 
##  Median : 9.0      Median : 10962           Median :0.000                 
##  Mean   :10.1      Mean   : 15245           Mean   :0.906                 
##  3rd Qu.:13.0      3rd Qu.: 18889           3rd Qu.:1.000                 
##  Max.   :38.0      Max.   :270800           Max.   :9.000                 
##  NA's   :2         NA's   :2                NA's   :2                     
##  Employment.Length
##  10+ years:653    
##  < 1 year :250    
##  2 years  :244    
##  3 years  :235    
##  5 years  :202    
##  4 years  :192    
##  (Other)  :724
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">sapply</span>(loans[1, ], class)
</pre></div><div class="output"><pre class="knitr r">##               Amount.Requested     Amount.Funded.By.Investors 
##                      "integer"                      "numeric" 
##                  Interest.Rate                    Loan.Length 
##                      "numeric"                      "numeric" 
##                   Loan.Purpose           Debt.To.Income.Ratio 
##                       "factor"                      "numeric" 
##                          State                 Home.Ownership 
##                       "factor"                       "factor" 
##                 Monthly.Income                     FICO.Range 
##                      "numeric"                       "factor" 
##              Open.CREDIT.Lines       Revolving.CREDIT.Balance 
##                      "integer"                      "integer" 
## Inquiries.in.the.Last.6.Months              Employment.Length 
##                      "integer"                       "factor"
</pre></div></div></div>


<h3>Find out about missing values</h3>
<div class="chunk" id="Find out Missing values"><div class="rcode"><div class="source"><pre class="knitr r"><span class="functioncall">sum</span>(<span class="functioncall">is.na</span>(loans))
</pre></div><div class="output"><pre class="knitr r">## [1] 7
</pre></div></div></div>


<h2>Exploratory Analysis</h2>
<h3>Make some univariate plots/summaries</h3>
<div class="chunk" id="Some unviariate plots/summaries"><div class="rcode"><div class="source"><pre class="knitr r"><span class="functioncall">hist</span>(loans$Amount.Requested, main = <span class="string">"Histogram of Amount Requested"</span>, xlab = <span class="string">"Amont Requested"</span>)
</pre></div></div><div class="rimage default"><img src="figure/Some unviariate plots/summaries1.png" title="plot of chunk Some unviariate plots/summaries" alt="plot of chunk Some unviariate plots/summaries" class="plot" /></div><div class="rcode">
<div class="source"><pre class="knitr r"><span class="functioncall">quantile</span>(loans$Amount.Requested)
</pre></div><div class="output"><pre class="knitr r">##    0%   25%   50%   75%  100% 
##  1000  6000 10000 17000 35000
</pre></div><div class="source"><pre class="knitr r">
<span class="functioncall">hist</span>(loans$Amount.Funded.By.Investors, main = <span class="string">"Histogram of Amount Funded By Investors"</span>, 
    xlab = <span class="string">"Amont Funded By Investors"</span>)
</pre></div></div><div class="rimage default"><img src="figure/Some unviariate plots/summaries2.png" title="plot of chunk Some unviariate plots/summaries" alt="plot of chunk Some unviariate plots/summaries" class="plot" /></div><div class="rcode">
<div class="source"><pre class="knitr r"><span class="functioncall">quantile</span>(loans$Amount.Funded.By.Investors)
</pre></div><div class="output"><pre class="knitr r">##       0%      25%      50%      75%     100% 
##    -0.01  6000.00 10000.00 16000.00 35000.00
</pre></div><div class="source"><pre class="knitr r">
<span class="functioncall">hist</span>(loans$Interest.Rate, main = <span class="string">"Histogram of Interest Rate"</span>, xlab = <span class="string">"Interest <span class="functioncall">Rate</span> (%)"</span>)
</pre></div></div><div class="rimage default"><img src="figure/Some unviariate plots/summaries3.png" title="plot of chunk Some unviariate plots/summaries" alt="plot of chunk Some unviariate plots/summaries" class="plot" /></div><div class="rcode">
<div class="source"><pre class="knitr r"><span class="functioncall">quantile</span>(loans$Interest.Rate)
</pre></div><div class="output"><pre class="knitr r">##    0%   25%   50%   75%  100% 
##  5.42 10.16 13.11 15.80 24.89
</pre></div><div class="source"><pre class="knitr r">
<span class="functioncall">hist</span>(loans$Loan.Length, main = <span class="string">"Histogram of Loan Lenght"</span>, xlab = <span class="string">"Loan <span class="functioncall">Lenght</span> (months)"</span>)
</pre></div></div><div class="rimage default"><img src="figure/Some unviariate plots/summaries4.png" title="plot of chunk Some unviariate plots/summaries" alt="plot of chunk Some unviariate plots/summaries" class="plot" /></div><div class="rcode">
<div class="source"><pre class="knitr r"><span class="functioncall">quantile</span>(loans$Loan.Length)
</pre></div><div class="output"><pre class="knitr r">##   0%  25%  50%  75% 100% 
##   36   36   36   36   60
</pre></div><div class="source"><pre class="knitr r">
<span class="functioncall">hist</span>(loans$Debt.To.Income.Ratio, main = <span class="string">"Histogram of Debt to Income Ratio"</span>, 
    xlab = <span class="string">"Debt to Income <span class="functioncall">Ratio</span> (%)"</span>)
</pre></div></div><div class="rimage default"><img src="figure/Some unviariate plots/summaries5.png" title="plot of chunk Some unviariate plots/summaries" alt="plot of chunk Some unviariate plots/summaries" class="plot" /></div><div class="rcode">
<div class="source"><pre class="knitr r"><span class="functioncall">quantile</span>(loans$Debt.To.Income.Ratio)
</pre></div><div class="output"><pre class="knitr r">##     0%    25%    50%    75%   100% 
##  0.000  9.748 15.320 20.672 34.910
</pre></div><div class="source"><pre class="knitr r">
<span class="functioncall">hist</span>(<span class="functioncall">log</span>(loans$Monthly.Income), main = <span class="string">"Histogram of <span class="functioncall">log</span>(Monthly Income)"</span>, xlab = <span class="string">"Monthly <span class="functioncall">Income</span> (<span class="functioncall">log</span>($))"</span>)
</pre></div></div><div class="rimage default"><img src="figure/Some unviariate plots/summaries6.png" title="plot of chunk Some unviariate plots/summaries" alt="plot of chunk Some unviariate plots/summaries" class="plot" /></div><div class="rcode">
<div class="source"><pre class="knitr r"><span class="functioncall">quantile</span>(loans$Monthly.Income, na.rm = <span class="keyword">TRUE</span>)
</pre></div><div class="output"><pre class="knitr r">##       0%      25%      50%      75%     100% 
##    588.5   3500.0   5000.0   6800.0 102750.0
</pre></div><div class="source"><pre class="knitr r">
<span class="functioncall">hist</span>(loans$Open.CREDIT.Lines, main = <span class="string">"Histogram of Number of Credit Lines"</span>, 
    xlab = <span class="string">"Number of Credit Lines"</span>)
</pre></div></div><div class="rimage default"><img src="figure/Some unviariate plots/summaries7.png" title="plot of chunk Some unviariate plots/summaries" alt="plot of chunk Some unviariate plots/summaries" class="plot" /></div><div class="rcode">
<div class="source"><pre class="knitr r"><span class="functioncall">quantile</span>(loans$Open.CREDIT.Lines, na.rm = <span class="keyword">TRUE</span>)
</pre></div><div class="output"><pre class="knitr r">##   0%  25%  50%  75% 100% 
##    2    7    9   13   38
</pre></div><div class="source"><pre class="knitr r">
<span class="functioncall">hist</span>(<span class="functioncall">log</span>(loans$Revolving.CREDIT.Balance), main = <span class="string">"Histogram of Revolving Credit Balance"</span>, 
    xlab = <span class="string">"Revolving Credit <span class="functioncall">Balance</span> (<span class="functioncall">log</span>($)"</span>)
</pre></div></div><div class="rimage default"><img src="figure/Some unviariate plots/summaries8.png" title="plot of chunk Some unviariate plots/summaries" alt="plot of chunk Some unviariate plots/summaries" class="plot" /></div><div class="rcode">
<div class="source"><pre class="knitr r"><span class="functioncall">quantile</span>(<span class="functioncall">log</span>(loans$Revolving.CREDIT.Balance), na.rm = <span class="keyword">TRUE</span>)
</pre></div><div class="output"><pre class="knitr r">##     0%    25%    50%    75%   100% 
##   -Inf  8.628  9.302  9.846 12.509
</pre></div><div class="source"><pre class="knitr r">
<span class="functioncall">hist</span>(loans$Inquiries.<span class="keyword">in</span>.the.Last.6.Months, main = <span class="string">"Histogram of Number Inquiries <span class="keyword">in</span> the last 6 months"</span>, 
    xlab = <span class="string">"Number of Inquiries <span class="keyword">in</span> the last 6 months"</span>)
</pre></div></div><div class="rimage default"><img src="figure/Some unviariate plots/summaries9.png" title="plot of chunk Some unviariate plots/summaries" alt="plot of chunk Some unviariate plots/summaries" class="plot" /></div><div class="rcode">
<div class="source"><pre class="knitr r"><span class="functioncall">quantile</span>(loans$Inquiries.<span class="keyword">in</span>.the.Last.6.Months, na.rm = <span class="keyword">TRUE</span>)
</pre></div><div class="output"><pre class="knitr r">##   0%  25%  50%  75% 100% 
##    0    0    0    1    9
</pre></div></div></div>


<h3>Make some univariate tables</h3>
<div class="chunk" id="unnamed-chunk-1"><div class="rcode"><div class="source"><pre class="knitr r"><span class="functioncall">summary</span>(loans$Loan.Purpose)
</pre></div><div class="output"><pre class="knitr r">##                car        credit_card debt_consolidation 
##                 50                444               1307 
##        educational   home_improvement              house 
##                 15                152                 20 
##     major_purchase            medical             moving 
##                101                 30                 29 
##              other   renewable_energy     small_business 
##                201                  4                 87 
##           vacation            wedding 
##                 21                 39
</pre></div><div class="source"><pre class="knitr r">
<span class="functioncall">summary</span>(loans$State)
</pre></div><div class="output"><pre class="knitr r">##  AK  AL  AR  AZ  CA  CO  CT  DC  DE  FL  GA  HI  IA  IL  IN  KS  KY  LA 
##  11  38  13  46 433  61  50  11   8 169  98  12   1 101   3  21  23  22 
##  MA  MD  MI  MN  MO  MS  MT  NC  NH  NJ  NM  NV  NY  OH  OK  OR  PA  RI 
##  73  68  45  38  33   1   7  64  15  94  13  32 255  71  21  30  96  15 
##  SC  SD  TX  UT  VA  VT  WA  WI  WV  WY 
##  28   4 174  16  78   5  58  26  15   4
</pre></div><div class="source"><pre class="knitr r">
<span class="functioncall">summary</span>(loans$Home.Ownership)
</pre></div><div class="output"><pre class="knitr r">## MORTGAGE     NONE    OTHER      OWN     RENT 
##     1148        1        5      200     1146
</pre></div><div class="source"><pre class="knitr r">
<span class="functioncall">summary</span>(loans$FICO.Range)
</pre></div><div class="output"><pre class="knitr r">## 640-644 645-649 650-654 655-659 660-664 665-669 670-674 675-679 680-684 
##       5       3       1       4     125     145     171     166     157 
## 685-689 690-694 695-699 700-704 705-709 710-714 715-719 720-724 725-729 
##     138     140     153     131     134     112      93     114      94 
## 730-734 735-739 740-744 745-749 750-754 755-759 760-764 765-769 770-774 
##      94      65      53      54      61      46      46      36      17 
## 775-779 780-784 785-789 790-794 795-799 800-804 805-809 810-814 815-819 
##      22      28      19      20      13      13      11       8       6 
## 820-824 830-834 
##       1       1
</pre></div><div class="source"><pre class="knitr r">
<span class="functioncall">summary</span>(loans$Employment.Length)
</pre></div><div class="output"><pre class="knitr r">##  < 1 year    1 year 10+ years   2 years   3 years   4 years   5 years 
##       250       177       653       244       235       192       202 
##   6 years   7 years   8 years   9 years       n/a 
##       163       127       108        72        77
</pre></div></div></div>


<h3>Plot Interest Rate vs Amount Requested (FICO Colored)</h3>
<div class="chunk" id="Plot Interest Rate vs Amount Requested"><div class="rcode"><div class="source"><pre class="knitr r"><span class="functioncall">par</span>(mar = <span class="functioncall">c</span>(4, 4, 2, 0.5), col = <span class="functioncall">palette</span>(<span class="functioncall">heat.colors</span>(48)))
<span class="functioncall">layout</span>(<span class="functioncall">matrix</span>(<span class="functioncall">c</span>(1, 1, 2, 2), 2, 2, byrow = F), widths = <span class="functioncall">c</span>(3, 1))
3
</pre></div><div class="output"><pre class="knitr r">## [1] 3
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">plot</span>(loans$Amount.Requested, loans$Interest.Rate, pch = 19, col = loans$FICO.Range, 
    ylab = <span class="string">"Interest <span class="functioncall">Rate</span> (%)"</span>, xlab = <span class="string">"Amount <span class="functioncall">Request</span> ($)"</span>, main = <span class="string">"Interest Rate vs Amount <span class="functioncall">Requested</span> (FICO Colored)"</span>, 
    cex = 0.7)
lmIRAR &lt;- <span class="functioncall">lm</span>(loans$Interest.Rate ~ loans$Amount.Requested)
<span class="functioncall">lines</span>(loans$Amount.Requested, lmIRAR$fitted, col = <span class="string">"Black"</span>, lwd = 3)
<span class="functioncall">plot.new</span>()
<span class="functioncall">legend</span>(<span class="string">"center"</span>, <span class="string">"groups"</span>, legend = <span class="functioncall">sort</span>(<span class="functioncall">unique</span>(loans$FICO.Range)), col = <span class="functioncall">sort</span>(<span class="functioncall">unique</span>(loans$FICO.Range)), 
    cex = 0.7, pch = 19, title = <span class="string">"FICO Score"</span>, ncol = 1)
<span class="functioncall">summary</span>(lmIRAR)
</pre></div><div class="output"><pre class="knitr r">## 
## Call:
## lm(formula = loans$Interest.Rate ~ loans$Amount.Requested)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -10.380  -3.009   0.022   2.717  11.913 
## 
## Coefficients:
##                        Estimate Std. Error t value Pr(>|t|)    
## (Intercept)            1.09e+01   1.48e-01    73.3   <2e-16 ***
## loans$Amount.Requested 1.78e-04   1.01e-05    17.6   <2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 
## 
## Residual standard error: 3.94 on 2498 degrees of freedom
## Multiple R-squared: 0.11,	Adjusted R-squared: 0.11 
## F-statistic:  310 on 1 and 2498 DF,  p-value: <2e-16
</pre></div></div><div class="rimage default"><img src="figure/Plot Interest Rate vs Amount Requested.png" title="plot of chunk Plot Interest Rate vs Amount Requested" alt="plot of chunk Plot Interest Rate vs Amount Requested" class="plot" /></div></div>


<h3>Plot Interest Rate vs Amount Funded By Investors (FICO Colored)</h3>
<div class="chunk" id="Plot Interest Rate vs Amount Funded By Investors"><div class="rcode"><div class="source"><pre class="knitr r"><span class="functioncall">par</span>(mar = <span class="functioncall">c</span>(4, 4, 2, 0.5), col = <span class="functioncall">palette</span>(<span class="functioncall">heat.colors</span>(48)))
<span class="functioncall">layout</span>(<span class="functioncall">matrix</span>(<span class="functioncall">c</span>(1, 1, 2, 2), 2, 2, byrow = F), widths = <span class="functioncall">c</span>(3, 1))
3
</pre></div><div class="output"><pre class="knitr r">## [1] 3
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">plot</span>(loans$Amount.Funded.By.Investors, loans$Interest.Rate, pch = 19, col = loans$FICO.Range, 
    ylab = <span class="string">"Interest <span class="functioncall">Rate</span> (%)"</span>, xlab = <span class="string">"Amount Funded By <span class="functioncall">Investors</span> ($)"</span>, main = <span class="string">"Interest Rate vs Amount Funded By <span class="functioncall">Investors</span> (FICO Colored)"</span>)
lmIRAFBI &lt;- <span class="functioncall">lm</span>(loans$Interest.Rate ~ loans$Amount.Funded.By.Investors)
<span class="functioncall">lines</span>(loans$Amount.Funded.By.Investors, lmIRAFBI$fitted, col = <span class="string">"black"</span>, lwd = 3)
<span class="functioncall">plot.new</span>()
<span class="functioncall">legend</span>(<span class="string">"center"</span>, <span class="string">"groups"</span>, legend = <span class="functioncall">sort</span>(<span class="functioncall">unique</span>(loans$FICO.Range)), col = <span class="functioncall">sort</span>(<span class="functioncall">unique</span>(loans$FICO.Range)), 
    cex = 0.7, pch = 19, title = <span class="string">"FICO Score"</span>, ncol = 1)
<span class="functioncall">summary</span>(lmIRAFBI)
</pre></div><div class="output"><pre class="knitr r">## 
## Call:
## lm(formula = loans$Interest.Rate ~ loans$Amount.Funded.By.Investors)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -10.53  -3.02   0.04   2.73  11.88 
## 
## Coefficients:
##                                  Estimate Std. Error t value Pr(>|t|)    
## (Intercept)                      1.09e+01   1.45e-01    75.0   <2e-16 ***
## loans$Amount.Funded.By.Investors 1.82e-04   1.02e-05    17.9   <2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 
## 
## Residual standard error: 3.93 on 2498 degrees of freedom
## Multiple R-squared: 0.114,	Adjusted R-squared: 0.113 
## F-statistic:  321 on 1 and 2498 DF,  p-value: <2e-16
</pre></div></div><div class="rimage default"><img src="figure/Plot Interest Rate vs Amount Funded By Investors.png" title="plot of chunk Plot Interest Rate vs Amount Funded By Investors" alt="plot of chunk Plot Interest Rate vs Amount Funded By Investors" class="plot" /></div></div>


<h3>Plot Interest Rate vs Loan Lenght</h3>
<div class="chunk" id="Plot Interest Rate vs Loan Lenght"><div class="rcode"><div class="source"><pre class="knitr r"><span class="functioncall">boxplot</span>(loans$Interest.Rate ~ loans$Loan.Length, ylab = <span class="string">"Interest <span class="functioncall">Rate</span>(%)"</span>, 
    xlab = <span class="string">"Loan <span class="functioncall">Lenght</span> (months)"</span>, main = <span class="string">"Plot Interest Rate vs Loan Lenght"</span>)
</pre></div></div><div class="rimage default"><img src="figure/Plot Interest Rate vs Loan Lenght.png" title="plot of chunk Plot Interest Rate vs Loan Lenght" alt="plot of chunk Plot Interest Rate vs Loan Lenght" class="plot" /></div><div class="rcode">
<div class="source"><pre class="knitr r">lmIRLL &lt;- <span class="functioncall">lm</span>(loans$Interest.Rate ~ loans$Loan.Length)
<span class="functioncall">summary</span>(lmIRLL)
</pre></div><div class="output"><pre class="knitr r">## 
## Call:
## lm(formula = loans$Interest.Rate ~ loans$Loan.Length)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -10.617  -3.229  -0.009   2.521  12.761 
## 
## Coefficients:
##                   Estimate Std. Error t value Pr(>|t|)    
## (Intercept)        5.71181    0.32360    17.6   <2e-16 ***
## loans$Loan.Length  0.17826    0.00763    23.4   <2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 
## 
## Residual standard error: 3.79 on 2498 degrees of freedom
## Multiple R-squared: 0.18,	Adjusted R-squared: 0.179 
## F-statistic:  547 on 1 and 2498 DF,  p-value: <2e-16
</pre></div></div></div>


<h3>Plot Interest Rate vs Loan Purpose</h3>
<div class="chunk" id="Plot Interest Rate vs Loan Purpose"><div class="rcode"><div class="source"><pre class="knitr r"><span class="functioncall">boxplot</span>(loans$Interest.Rate ~ loans$Loan.Purpose, ylab = <span class="string">"Interest <span class="functioncall">Rate</span>(%)"</span>, 
    main = <span class="string">"Plot Interest Rate vs Loan Porpose"</span>, las = 3, cex.axis = 0.6)
</pre></div></div><div class="rimage default"><img src="figure/Plot Interest Rate vs Loan Purpose.png" title="plot of chunk Plot Interest Rate vs Loan Purpose" alt="plot of chunk Plot Interest Rate vs Loan Purpose" class="plot" /></div><div class="rcode">
<div class="source"><pre class="knitr r">lmIRLP &lt;- <span class="functioncall">lm</span>(loans$Interest.Rate ~ loans$Loan.Purpose)
<span class="functioncall">summary</span>(lmIRLP)
</pre></div><div class="output"><pre class="knitr r">## 
## Call:
## lm(formula = loans$Interest.Rate ~ loans$Loan.Purpose)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -7.831 -3.047 -0.097  2.703 11.656 
## 
## Coefficients:
##                                      Estimate Std. Error t value Pr(>|t|)
## (Intercept)                            11.113      0.581   19.12  < 2e-16
## loans$Loan.Purposecredit_card           1.931      0.613    3.15   0.0017
## loans$Loan.Purposedebt_consolidation    2.474      0.592    4.18  3.1e-05
## loans$Loan.Purposeeducational          -0.106      1.210   -0.09   0.9304
## loans$Loan.Purposehome_improvement      0.481      0.670    0.72   0.4727
## loans$Loan.Purposehouse                 2.335      1.087    2.15   0.0319
## loans$Loan.Purposemajor_purchase       -0.315      0.711   -0.44   0.6575
## loans$Loan.Purposemedical               0.537      0.949    0.57   0.5719
## loans$Loan.Purposemoving                2.508      0.959    2.61   0.0090
## loans$Loan.Purposeother                 2.047      0.650    3.15   0.0016
## loans$Loan.Purposerenewable_energy     -1.235      2.136   -0.58   0.5630
## loans$Loan.Purposesmall_business        1.726      0.729    2.37   0.0180
## loans$Loan.Purposevacation              0.853      1.069    0.80   0.4248
## loans$Loan.Purposewedding               1.138      0.878    1.30   0.1952
##                                         
## (Intercept)                          ***
## loans$Loan.Purposecredit_card        ** 
## loans$Loan.Purposedebt_consolidation ***
## loans$Loan.Purposeeducational           
## loans$Loan.Purposehome_improvement      
## loans$Loan.Purposehouse              *  
## loans$Loan.Purposemajor_purchase        
## loans$Loan.Purposemedical               
## loans$Loan.Purposemoving             ** 
## loans$Loan.Purposeother              ** 
## loans$Loan.Purposerenewable_energy      
## loans$Loan.Purposesmall_business     *  
## loans$Loan.Purposevacation              
## loans$Loan.Purposewedding               
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 
## 
## Residual standard error: 4.11 on 2486 degrees of freedom
## Multiple R-squared: 0.0373,	Adjusted R-squared: 0.0323 
## F-statistic: 7.41 on 13 and 2486 DF,  p-value: 1.7e-14
</pre></div></div></div>


<h3>Plot Interest Rate vs Debt to income ratio (FICO Colored)</h3>
<div class="chunk" id="Plot Interest Rate vs Debt to income ratio"><div class="rcode"><div class="source"><pre class="knitr r"><span class="functioncall">par</span>(mar = <span class="functioncall">c</span>(4, 4, 2, 0.5), col = <span class="functioncall">palette</span>(<span class="functioncall">heat.colors</span>(48)))
<span class="functioncall">layout</span>(<span class="functioncall">matrix</span>(<span class="functioncall">c</span>(1, 1, 2, 2), 2, 2, byrow = F), widths = <span class="functioncall">c</span>(3, 1))
3
</pre></div><div class="output"><pre class="knitr r">## [1] 3
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">plot</span>(loans$Debt.To.Income.Ratio, loans$Interest.Rate, pch = 19, col = loans$FICO.Range, 
    ylab = <span class="string">"Interest <span class="functioncall">Rate</span> (%)"</span>, xlab = <span class="string">"Debt to income <span class="functioncall">ratio</span> (%)"</span>, main = <span class="string">"Interest Rate vs Debt to income <span class="functioncall">ratio</span> (FICO Colored)"</span>)
lmIRDIR &lt;- <span class="functioncall">lm</span>(loans$Interest.Rate ~ loans$Debt.To.Income.Ratio)
<span class="functioncall">lines</span>(loans$Debt.To.Income.Ratio, lmIRDIR$fitted, col = <span class="string">"black"</span>, lwd = 3)
<span class="functioncall">plot.new</span>()
<span class="functioncall">legend</span>(<span class="string">"center"</span>, <span class="string">"groups"</span>, legend = <span class="functioncall">sort</span>(<span class="functioncall">unique</span>(loans$FICO.Range)), col = <span class="functioncall">sort</span>(<span class="functioncall">unique</span>(loans$FICO.Range)), 
    cex = 0.7, pch = 19, title = <span class="string">"FICO Score"</span>, ncol = 1)
<span class="functioncall">summary</span>(lmIRDIR)
</pre></div><div class="output"><pre class="knitr r">## 
## Call:
## lm(formula = loans$Interest.Rate ~ loans$Debt.To.Income.Ratio)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -8.801 -3.018 -0.115  2.604 12.319 
## 
## Coefficients:
##                            Estimate Std. Error t value Pr(>|t|)    
## (Intercept)                 11.5842     0.1877   61.71   <2e-16 ***
## loans$Debt.To.Income.Ratio   0.0964     0.0110    8.79   <2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 
## 
## Residual standard error: 4.12 on 2498 degrees of freedom
## Multiple R-squared: 0.03,	Adjusted R-squared: 0.0296 
## F-statistic: 77.3 on 1 and 2498 DF,  p-value: <2e-16
</pre></div></div><div class="rimage default"><img src="figure/Plot Interest Rate vs Debt to income ratio.png" title="plot of chunk Plot Interest Rate vs Debt to income ratio" alt="plot of chunk Plot Interest Rate vs Debt to income ratio" class="plot" /></div></div>


<h3>Plot Interest Rate vs State</h3>
<div class="chunk" id="Plot Interest Rate vs State"><div class="rcode"><div class="source"><pre class="knitr r"><span class="functioncall">boxplot</span>(loans$Interest.Rate ~ loans$State, xlab = <span class="string">"State"</span>, ylab = <span class="string">"Interest <span class="functioncall">Rate</span>(%)"</span>, 
    main = <span class="string">"Plot Interest Rate vs State"</span>, las = 3, cex.axis = 0.6)
</pre></div></div><div class="rimage default"><img src="figure/Plot Interest Rate vs State.png" title="plot of chunk Plot Interest Rate vs State" alt="plot of chunk Plot Interest Rate vs State" class="plot" /></div><div class="rcode">
<div class="source"><pre class="knitr r">lmIRST &lt;- <span class="functioncall">lm</span>(loans$Interest.Rate ~ loans$State)
<span class="functioncall">summary</span>(lmIRST)
</pre></div><div class="output"><pre class="knitr r">## 
## Call:
## lm(formula = loans$Interest.Rate ~ loans$State)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -8.092 -2.942 -0.064  2.714 12.719 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(>|t|)    
## (Intercept)     16.595      1.257   13.20   <2e-16 ***
## loans$StateAL   -3.450      1.428   -2.42   0.0158 *  
## loans$StateAR   -3.365      1.709   -1.97   0.0490 *  
## loans$StateAZ   -3.444      1.400   -2.46   0.0139 *  
## loans$StateCA   -3.639      1.273   -2.86   0.0043 ** 
## loans$StateCO   -3.675      1.366   -2.69   0.0072 ** 
## loans$StateCT   -2.874      1.389   -2.07   0.0387 *  
## loans$StateDC   -2.853      1.778   -1.60   0.1088    
## loans$StateDE   -4.933      1.938   -2.55   0.0110 *  
## loans$StateFL   -3.630      1.298   -2.80   0.0052 ** 
## loans$StateGA   -4.050      1.326   -3.05   0.0023 ** 
## loans$StateHI   -0.610      1.741   -0.35   0.7259    
## loans$StateIA   -2.475      4.356   -0.57   0.5700    
## loans$StateIL   -3.978      1.324   -3.00   0.0027 ** 
## loans$StateIN   -3.505      2.716   -1.29   0.1971    
## loans$StateKS   -2.877      1.552   -1.85   0.0639 .  
## loans$StateKY   -4.212      1.529   -2.75   0.0059 ** 
## loans$StateLA   -1.674      1.540   -1.09   0.2771    
## loans$StateMA   -3.982      1.349   -2.95   0.0032 ** 
## loans$StateMD   -3.316      1.355   -2.45   0.0145 *  
## loans$StateMI   -2.219      1.403   -1.58   0.1138    
## loans$StateMN   -2.973      1.428   -2.08   0.0375 *  
## loans$StateMO   -3.811      1.452   -2.62   0.0087 ** 
## loans$StateMS   -0.945      4.356   -0.22   0.8284    
## loans$StateMT   -5.820      2.016   -2.89   0.0039 ** 
## loans$StateNC   -3.954      1.361   -2.90   0.0037 ** 
## loans$StateNH   -4.423      1.656   -2.67   0.0076 ** 
## loans$StateNJ   -3.816      1.329   -2.87   0.0041 ** 
## loans$StateNM   -2.269      1.709   -1.33   0.1843    
## loans$StateNV   -3.082      1.458   -2.11   0.0346 *  
## loans$StateNY   -3.492      1.284   -2.72   0.0066 ** 
## loans$StateOH   -4.335      1.351   -3.21   0.0014 ** 
## loans$StateOK   -2.814      1.552   -1.81   0.0700 .  
## loans$StateOR   -3.938      1.470   -2.68   0.0074 ** 
## loans$StatePA   -4.056      1.328   -3.06   0.0023 ** 
## loans$StateRI   -3.581      1.656   -2.16   0.0306 *  
## loans$StateSC   -3.804      1.484   -2.56   0.0104 *  
## loans$StateSD   -6.342      2.435   -2.60   0.0093 ** 
## loans$StateTX   -3.213      1.297   -2.48   0.0133 *  
## loans$StateUT   -3.420      1.634   -2.09   0.0364 *  
## loans$StateVA   -3.257      1.343   -2.42   0.0154 *  
## loans$StateVT    1.289      2.249    0.57   0.5665    
## loans$StateWA   -3.617      1.372   -2.64   0.0084 ** 
## loans$StateWI   -2.713      1.500   -1.81   0.0707 .  
## loans$StateWV   -2.486      1.656   -1.50   0.1333    
## loans$StateWY   -3.130      2.435   -1.29   0.1988    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 
## 
## Residual standard error: 4.17 on 2454 degrees of freedom
## Multiple R-squared: 0.0216,	Adjusted R-squared: 0.00366 
## F-statistic:  1.2 on 45 and 2454 DF,  p-value: 0.167
</pre></div></div></div>


<h3>Plot Interest Rate vs Home Ownership</h3>
<div class="chunk" id="Plot Interest Rate vs Home Ownership"><div class="rcode"><div class="source"><pre class="knitr r"><span class="functioncall">boxplot</span>(loans$Interest.Rate ~ loans$Home.Ownership, xlab = <span class="string">"Home Ownership"</span>, 
    ylab = <span class="string">"Interest <span class="functioncall">Rate</span>(%)"</span>, main = <span class="string">"Plot Interest Rate vs Home Ownership"</span>, 
    las = 3, cex.axis = 0.6)
</pre></div></div><div class="rimage default"><img src="figure/Plot Interest Rate vs Home Ownership.png" title="plot of chunk Plot Interest Rate vs Home Ownership" alt="plot of chunk Plot Interest Rate vs Home Ownership" class="plot" /></div><div class="rcode">
<div class="source"><pre class="knitr r">lmIRHO &lt;- <span class="functioncall">lm</span>(loans$Interest.Rate ~ loans$Home.Ownership)
<span class="functioncall">summary</span>(lmIRHO)
</pre></div><div class="output"><pre class="knitr r">## 
## Call:
## lm(formula = loans$Interest.Rate ~ loans$Home.Ownership)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -7.994 -2.981 -0.214  2.569 12.149 
## 
## Coefficients:
##                           Estimate Std. Error t value Pr(>|t|)    
## (Intercept)                 12.741      0.123  103.64  < 2e-16 ***
## loans$Home.OwnershipNONE    -5.311      4.167   -1.27  0.20259    
## loans$Home.OwnershipOTHER    3.297      1.867    1.77  0.07750 .  
## loans$Home.OwnershipOWN      0.165      0.319    0.52  0.60540    
## loans$Home.OwnershipRENT     0.672      0.174    3.87  0.00011 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 
## 
## Residual standard error: 4.17 on 2495 degrees of freedom
## Multiple R-squared: 0.00781,	Adjusted R-squared: 0.00622 
## F-statistic: 4.91 on 4 and 2495 DF,  p-value: 0.000608
</pre></div></div></div>


<h3>Plot Interest Rate vs Monthly Income (log) (FICO Colored)</h3>
<div class="chunk" id="Plot Interest Rate vs Monthly Income"><div class="rcode"><div class="source"><pre class="knitr r"><span class="functioncall">par</span>(mar = <span class="functioncall">c</span>(4, 4, 2, 0.5), col = <span class="functioncall">palette</span>(<span class="functioncall">heat.colors</span>(48)))
<span class="functioncall">layout</span>(<span class="functioncall">matrix</span>(<span class="functioncall">c</span>(1, 1, 2, 2), 2, 2, byrow = F), widths = <span class="functioncall">c</span>(3, 1))
3
</pre></div><div class="output"><pre class="knitr r">## [1] 3
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">plot</span>(<span class="functioncall">log</span>(loans$Monthly.Income), loans$Interest.Rate, pch = 19, col = loans$FICO.Range, 
    ylab = <span class="string">"Interest <span class="functioncall">Rate</span> (%)"</span>, xlab = <span class="string">"Monthly <span class="functioncall">Income</span> (<span class="functioncall">log</span>($))"</span>, main = <span class="string">"Interest Rate vs <span class="functioncall">log</span>(Monthly Income) (FICO Colored)"</span>)
lmIRMI &lt;- <span class="functioncall">lm</span>(loans$Interest.Rate ~ <span class="functioncall">log</span>(loans$Monthly.Income))
<span class="functioncall">lines</span>(<span class="functioncall">log</span>(loans[!<span class="functioncall">is.na</span>(loans$Monthly.Income), <span class="string">"Monthly.Income"</span>]), lmIRMI$fitted, 
    col = <span class="string">"black"</span>, lwd = 3)
<span class="functioncall">plot.new</span>()
<span class="functioncall">legend</span>(<span class="string">"center"</span>, <span class="string">"groups"</span>, legend = <span class="functioncall">sort</span>(<span class="functioncall">unique</span>(loans$FICO.Range)), col = <span class="functioncall">sort</span>(<span class="functioncall">unique</span>(loans$FICO.Range)), 
    cex = 0.7, pch = 19, title = <span class="string">"FICO Score"</span>, ncol = 1)
<span class="functioncall">summary</span>(lmIRMI)
</pre></div><div class="output"><pre class="knitr r">## 
## Call:
## lm(formula = loans$Interest.Rate ~ log(loans$Monthly.Income))
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -7.892 -3.002  0.008  2.723 11.892 
## 
## Coefficients:
##                           Estimate Std. Error t value Pr(>|t|)    
## (Intercept)                 10.159      1.360    7.47  1.1e-13 ***
## log(loans$Monthly.Income)    0.342      0.160    2.14    0.032 *  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 
## 
## Residual standard error: 4.17 on 2497 degrees of freedom
##   (1 observation deleted due to missingness)
## Multiple R-squared: 0.00184,	Adjusted R-squared: 0.00144 
## F-statistic: 4.59 on 1 and 2497 DF,  p-value: 0.0322
</pre></div></div><div class="rimage default"><img src="figure/Plot Interest Rate vs Monthly Income.png" title="plot of chunk Plot Interest Rate vs Monthly Income" alt="plot of chunk Plot Interest Rate vs Monthly Income" class="plot" /></div></div>


<h3>Plot Interest Rate vs FICO Range</h3>
<div class="chunk" id="Plot Interest Rate vs FICO Range"><div class="rcode"><div class="source"><pre class="knitr r"><span class="functioncall">boxplot</span>(loans$Interest.Rate ~ loans$FICO.Range, xlab = <span class="string">"FICO Range"</span>, ylab = <span class="string">"Interest <span class="functioncall">Rate</span>(%)"</span>, 
    main = <span class="string">"Plot Interest Rate vs FICO Range"</span>, las = 3, cex.axis = 0.6)
</pre></div></div><div class="rimage default"><img src="figure/Plot Interest Rate vs FICO Range.png" title="plot of chunk Plot Interest Rate vs FICO Range" alt="plot of chunk Plot Interest Rate vs FICO Range" class="plot" /></div><div class="rcode">
<div class="source"><pre class="knitr r">lmIRFR &lt;- <span class="functioncall">lm</span>(loans$Interest.Rate ~ loans$FICO.Range)
<span class="functioncall">summary</span>(lmIRFR)
</pre></div><div class="output"><pre class="knitr r">## 
## Call:
## lm(formula = loans$Interest.Rate ~ loans$FICO.Range)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -8.147 -2.041 -0.492  1.666 10.403 
## 
## Coefficients:
##                         Estimate Std. Error t value Pr(>|t|)    
## (Intercept)              15.2120     1.2697   11.98  < 2e-16 ***
## loans$FICO.Range645-649  -0.3287     2.0734   -0.16  0.87406    
## loans$FICO.Range650-654  -0.0820     3.1101   -0.03  0.97897    
## loans$FICO.Range655-659  -0.2820     1.9045   -0.15  0.88230    
## loans$FICO.Range660-664   3.2805     1.2948    2.53  0.01135 *  
## loans$FICO.Range665-669   2.2361     1.2914    1.73  0.08348 .  
## loans$FICO.Range670-674   1.0365     1.2881    0.80  0.42110    
## loans$FICO.Range675-679   0.6427     1.2887    0.50  0.61801    
## loans$FICO.Range680-684  -0.0853     1.2897   -0.07  0.94727    
## loans$FICO.Range685-689  -0.5571     1.2925   -0.43  0.66646    
## loans$FICO.Range690-694  -0.4799     1.2922   -0.37  0.71036    
## loans$FICO.Range695-699  -1.0651     1.2903   -0.83  0.40915    
## loans$FICO.Range700-704  -1.8551     1.2937   -1.43  0.15170    
## loans$FICO.Range705-709  -2.5521     1.2931   -1.97  0.04854 *  
## loans$FICO.Range710-714  -2.7789     1.2977   -2.14  0.03234 *  
## loans$FICO.Range715-719  -4.0301     1.3034   -3.09  0.00201 ** 
## loans$FICO.Range720-724  -4.1762     1.2972   -3.22  0.00130 ** 
## loans$FICO.Range725-729  -4.5590     1.3030   -3.50  0.00048 ***
## loans$FICO.Range730-734  -5.2558     1.3030   -4.03  5.7e-05 ***
## loans$FICO.Range735-739  -5.5885     1.3176   -4.24  2.3e-05 ***
## loans$FICO.Range740-744  -5.6197     1.3282   -4.23  2.4e-05 ***
## loans$FICO.Range745-749  -5.3103     1.3272   -4.00  6.5e-05 ***
## loans$FICO.Range750-754  -6.7443     1.3207   -5.11  3.5e-07 ***
## loans$FICO.Range755-759  -6.2159     1.3369   -4.65  3.5e-06 ***
## loans$FICO.Range760-764  -6.5844     1.3369   -4.93  9.0e-07 ***
## loans$FICO.Range765-769  -7.4287     1.3550   -5.48  4.6e-08 ***
## loans$FICO.Range770-774  -8.4591     1.4444   -5.86  5.4e-09 ***
## loans$FICO.Range775-779  -6.4679     1.4066   -4.60  4.5e-06 ***
## loans$FICO.Range780-784  -7.6227     1.3784   -5.53  3.5e-08 ***
## loans$FICO.Range785-789  -6.7141     1.4270   -4.71  2.7e-06 ***
## loans$FICO.Range790-794  -7.6515     1.4195   -5.39  7.7e-08 ***
## loans$FICO.Range795-799  -6.8205     1.4940   -4.57  5.2e-06 ***
## loans$FICO.Range800-804  -7.5735     1.4940   -5.07  4.3e-07 ***
## loans$FICO.Range805-809  -7.7856     1.5313   -5.08  4.0e-07 ***
## loans$FICO.Range810-814  -6.9183     1.6185   -4.27  2.0e-05 ***
## loans$FICO.Range815-819  -8.2870     1.7192   -4.82  1.5e-06 ***
## loans$FICO.Range820-824  -7.3120     3.1101   -2.35  0.01880 *  
## loans$FICO.Range830-834  -7.5920     3.1101   -2.44  0.01471 *  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 
## 
## Residual standard error: 2.84 on 2462 degrees of freedom
## Multiple R-squared: 0.545,	Adjusted R-squared: 0.538 
## F-statistic: 79.7 on 37 and 2462 DF,  p-value: <2e-16
</pre></div></div></div>


<h3>Plot Interest Rate vs Open Credit Lines</h3>
<div class="chunk" id="Plot Interest Rate vs Open Credit Lines"><div class="rcode"><div class="source"><pre class="knitr r"><span class="functioncall">boxplot</span>(loans$Interest.Rate ~ loans$Open.CREDIT.Lines, xlab = <span class="string">"Open Credit Lines"</span>, 
    ylab = <span class="string">"Interest <span class="functioncall">Rate</span>(%)"</span>, main = <span class="string">"Plot Interest Rate vs Open Credit Lines"</span>, 
    las = 3, cex.axis = 0.6)
</pre></div></div><div class="rimage default"><img src="figure/Plot Interest Rate vs Open Credit Lines.png" title="plot of chunk Plot Interest Rate vs Open Credit Lines" alt="plot of chunk Plot Interest Rate vs Open Credit Lines" class="plot" /></div><div class="rcode">
<div class="source"><pre class="knitr r">lmIROC &lt;- <span class="functioncall">lm</span>(loans$Interest.Rate ~ loans$Open.CREDIT.Lines)
<span class="functioncall">summary</span>(lmIROC)
</pre></div><div class="output"><pre class="knitr r">## 
## Call:
## lm(formula = loans$Interest.Rate ~ loans$Open.CREDIT.Lines)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -8.397 -3.033 -0.039  2.664 11.826 
## 
## Coefficients:
##                         Estimate Std. Error t value Pr(>|t|)    
## (Intercept)              12.2272     0.2039   59.97  < 2e-16 ***
## loans$Open.CREDIT.Lines   0.0837     0.0185    4.53  6.2e-06 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 
## 
## Residual standard error: 4.16 on 2496 degrees of freedom
##   (2 observations deleted due to missingness)
## Multiple R-squared: 0.00816,	Adjusted R-squared: 0.00776 
## F-statistic: 20.5 on 1 and 2496 DF,  p-value: 6.17e-06
</pre></div></div></div>


<h3>Plot Interest Rate vs Revolving Credit Balance (log) (FICO Colored)</h3>
<div class="chunk" id="Plot Interest Rate vs Revolving Credit Balance (log)"><div class="rcode"><div class="source"><pre class="knitr r"><span class="functioncall">par</span>(mar = <span class="functioncall">c</span>(4, 4, 2, 0.5), col = <span class="functioncall">palette</span>(<span class="functioncall">heat.colors</span>(48)))
<span class="functioncall">layout</span>(<span class="functioncall">matrix</span>(<span class="functioncall">c</span>(1, 1, 2, 2), 2, 2, byrow = F), widths = <span class="functioncall">c</span>(3, 1))
3
</pre></div><div class="output"><pre class="knitr r">## [1] 3
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">plot</span>(<span class="functioncall">log</span>(loans$Revolving.CREDIT.Balance + 1), loans$Interest.Rate, pch = 19, 
    col = loans$FICO.Range, ylab = <span class="string">"Interest <span class="functioncall">Rate</span> (%)"</span>, xlab = <span class="string">"Revolving Credit <span class="functioncall">Balance</span>(<span class="functioncall">log</span>($))"</span>, 
    main = <span class="string">"Interest Rate vs Revolving Credit <span class="functioncall">Balance</span> (FICO Colored)"</span>)
lmIRRCB &lt;- <span class="functioncall">lm</span>(loans$Interest.Rate ~ <span class="functioncall">log</span>(loans$Revolving.CREDIT.Balance + 1))
<span class="functioncall">lines</span>(<span class="functioncall">log</span>(loans[!<span class="functioncall">is.na</span>(loans$Revolving.CREDIT.Balance), <span class="string">"Revolving.CREDIT.Balance"</span>] + 
    1), lmIRRCB$fitted, col = <span class="string">"black"</span>, lwd = 3)
<span class="functioncall">plot.new</span>()
<span class="functioncall">legend</span>(<span class="string">"center"</span>, <span class="string">"groups"</span>, legend = <span class="functioncall">sort</span>(<span class="functioncall">unique</span>(loans$FICO.Range)), col = <span class="functioncall">sort</span>(<span class="functioncall">unique</span>(loans$FICO.Range)), 
    cex = 0.7, pch = 19, title = <span class="string">"FICO Score"</span>, ncol = 1)
<span class="functioncall">summary</span>(lmIRRCB)
</pre></div><div class="output"><pre class="knitr r">## 
## Call:
## lm(formula = loans$Interest.Rate ~ log(loans$Revolving.CREDIT.Balance + 
##     1))
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -8.161 -3.060 -0.077  2.686 12.302 
## 
## Coefficients:
##                                         Estimate Std. Error t value
## (Intercept)                                9.808      0.476   20.59
## log(loans$Revolving.CREDIT.Balance + 1)    0.361      0.052    6.95
##                                         Pr(>|t|)    
## (Intercept)                              < 2e-16 ***
## log(loans$Revolving.CREDIT.Balance + 1)  4.5e-12 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 
## 
## Residual standard error: 4.14 on 2496 degrees of freedom
##   (2 observations deleted due to missingness)
## Multiple R-squared: 0.019,	Adjusted R-squared: 0.0186 
## F-statistic: 48.4 on 1 and 2496 DF,  p-value: 4.5e-12
</pre></div></div><div class="rimage default"><img src="figure/Plot Interest Rate vs Revolving Credit Balance (log).png" title="plot of chunk Plot Interest Rate vs Revolving Credit Balance (log)" alt="plot of chunk Plot Interest Rate vs Revolving Credit Balance (log)" class="plot" /></div></div>


<h3>Plot Interest Rate vs Inquiries in the last 6 months</h3>
<div class="chunk" id="Plot Interest Rate vs Inquiries in the last 6 months"><div class="rcode"><div class="source"><pre class="knitr r"><span class="functioncall">boxplot</span>(loans$Interest.Rate ~ loans$Inquiries.<span class="keyword">in</span>.the.Last.6.Months, xlab = <span class="string">"Number of Inquiries <span class="keyword">in</span> the last 6 months"</span>, 
    ylab = <span class="string">"Interest <span class="functioncall">Rate</span>(%)"</span>, main = <span class="string">"Plot Interest Rate vs Open Credit Lines"</span>, 
    las = 3, cex.axis = 0.6)
</pre></div></div><div class="rimage default"><img src="figure/Plot Interest Rate vs Inquiries in the last 6 months.png" title="plot of chunk Plot Interest Rate vs Inquiries in the last 6 months" alt="plot of chunk Plot Interest Rate vs Inquiries in the last 6 months" class="plot" /></div><div class="rcode">
<div class="source"><pre class="knitr r">lmIRIL6M &lt;- <span class="functioncall">lm</span>(loans$Interest.Rate ~ loans$Inquiries.<span class="keyword">in</span>.the.Last.6.Months)
<span class="functioncall">summary</span>(lmIRIL6M)
</pre></div><div class="output"><pre class="knitr r">## 
## Call:
## lm(formula = loans$Interest.Rate ~ loans$Inquiries.in.the.Last.6.Months)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -8.262 -2.941 -0.144  2.670 11.766 
## 
## Coefficients:
##                                      Estimate Std. Error t value Pr(>|t|)
## (Intercept)                            12.564      0.102  122.67   <2e-16
## loans$Inquiries.in.the.Last.6.Months    0.559      0.067    8.34   <2e-16
##                                         
## (Intercept)                          ***
## loans$Inquiries.in.the.Last.6.Months ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 
## 
## Residual standard error: 4.12 on 2496 degrees of freedom
##   (2 observations deleted due to missingness)
## Multiple R-squared: 0.0271,	Adjusted R-squared: 0.0267 
## F-statistic: 69.5 on 1 and 2496 DF,  p-value: <2e-16
</pre></div></div></div>


<h3>Plot Interest Rate vs Employment Length</h3>
<div class="chunk" id="Plot Interest Rate vs Employment Length"><div class="rcode"><div class="source"><pre class="knitr r"><span class="functioncall">boxplot</span>(loans$Interest.Rate ~ loans$Employment.Length, xlab = <span class="string">"Employment Length"</span>, 
    ylab = <span class="string">"Interest <span class="functioncall">Rate</span>(%)"</span>, main = <span class="string">"Plot Interest Rate vs Employment Length"</span>, 
    las = 3, cex.axis = 0.6)
</pre></div></div><div class="rimage default"><img src="figure/Plot Interest Rate vs Employment Length.png" title="plot of chunk Plot Interest Rate vs Employment Length" alt="plot of chunk Plot Interest Rate vs Employment Length" class="plot" /></div><div class="rcode">
<div class="source"><pre class="knitr r">lmIREL &lt;- <span class="functioncall">lm</span>(loans$Interest.Rate ~ loans$Employment.Length)
<span class="functioncall">summary</span>(lmIREL)
</pre></div><div class="output"><pre class="knitr r">## 
## Call:
## lm(formula = loans$Interest.Rate ~ loans$Employment.Length)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -7.916 -3.010 -0.044  2.662 11.882 
## 
## Coefficients:
##                                  Estimate Std. Error t value Pr(>|t|)    
## (Intercept)                      12.85096    0.26427   48.63   <2e-16 ***
## loans$Employment.Length1 year    -0.36412    0.41046   -0.89     0.38    
## loans$Employment.Length10+ years  0.48527    0.31077    1.56     0.12    
## loans$Employment.Length2 years   -0.00403    0.37602   -0.01     0.99    
## loans$Employment.Length3 years   -0.08143    0.37965   -0.21     0.83    
## loans$Employment.Length4 years    0.28706    0.40097    0.72     0.47    
## loans$Employment.Length5 years    0.54854    0.39531    1.39     0.17    
## loans$Employment.Length6 years    0.44027    0.42066    1.05     0.30    
## loans$Employment.Length7 years    0.24526    0.45532    0.54     0.59    
## loans$Employment.Length8 years    0.15663    0.48115    0.33     0.74    
## loans$Employment.Length9 years    0.30321    0.55887    0.54     0.59    
## loans$Employment.Lengthn/a        0.00255    0.54460    0.00     1.00    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 
## 
## Residual standard error: 4.18 on 2488 degrees of freedom
## Multiple R-squared: 0.00429,	Adjusted R-squared: -0.000111 
## F-statistic: 0.975 on 11 and 2488 DF,  p-value: 0.467
</pre></div></div></div>

</body>
</html>
